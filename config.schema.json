{
  "pluginAlias": "SmartSprinklers",
  "headerDisplay": "Homebridge plugin for climate based adaptive irrigation sprinkler control. Default [values][range] mentioned in description.",
  "footerDisplay": "Created by Mayank Tandon - @mTry",
  "pluginType": "accessory",
  "singular": true,
 
  "schema": {
    "type": "object",
    "properties": {
      "accessory": {
          "default": "SmartSprinklers",
          "type": "string"
      },
      "name": {
          "title": "Accessory Name:",
          "description": "Name for the accessory [Irrigation]",
          "type": "string",
          "required": true,
          "default": "Irrigation"
        },
      "verbosed": {
      "title": "Verbose Calculations and Extended Climate data",
      "description": "Enable for more detailed calculation variables display. [true]",
      "type": "boolean",
      "required": false,
      "default": true
      },
      "masterDisable": {
      "title": "Disable scheduling",
      "description": "Disable scheduling all irrigation. [false]",
      "type": "boolean",
      "required": false,
      "default": false
      },
      "latitude": {
      "title": "Latitude:",
      "description": "Enter the latitude in decimals including '-' if in the southern hemisphere. [-90 - 90]",
      "type": "number",
      "required": true,
      "minimum": -90,
      "maximum": 90,
      "default": 0.0
      },
      "longitude": {
      "title": "Longitude:",
      "description": "Enter the longitude in decimals. [-180 - 180]",
      "type": "number",
      "required": true,
      "minimum": -180,
      "maximum": 180,
      "default": 0.0
      },
      "altitude": {
      "title": "Altitude:",
      "description": "Enter the altitude in meters. [0-10000m]",
      "type": "number",
      "required": true,
      "minimum": 0,
      "maximum": 10000,
      "default": 0.0
      },
      "keyAPI": {
      "title": "API Key:",
      "description": "Enter your OpenWeatherMap API Key.",
      "type": "string",
      "required": true
      },
      "cycles": {
      "title": "Cycles per zone:",
      "description": "Number of cycles per zone (watering is spread between cycles). [2][1 - 5]",
      "type": "number",
      "required": false,
      "minimum": 1,
      "maximum": 5,
      "default": 2
      },
      "sunriseOffset": {
      "title": "Sunrise Offest:",
      "description": "Minutes before the sunrise watering should get over by. [0]",
      "type": "number",
      "required": false,
      "minimum": -1440,
      "maximum": 1440,
      "default": 0
      },        
     "lowThreshold": {
      "title": "Low Threshold Temperature:",
      "description": "Skip scheduling when forecasted minimum temperature falls below this. [10°C][4°C - 20°C]",
      "type": "number",
      "required": false,
      "minimum": 4,
      "maximum": 20,
      "default": 10
      },
      "highThreshold": {
      "title": "High Threshold Temperature:",
      "description": "Skip scheduling when forecasted maximum temperature stays below this. [20°C][10°C - 30°C]",
      "type": "number",
      "required": false,
      "minimum": 10,
      "maximum": 30,
      "default": 20
      },

      "JanRad": {"type": "number", "title": "January", "default":6},
      "FebRad": {"type": "number", "title": "February", "default":6},
      "MarRad": {"type": "number", "title": "March", "default":6},
      "AprRad": {"type": "number", "title": "April", "default":6},
      "MayRad": {"type": "number", "title": "May", "default":6},
      "JunRad": {"type": "number", "title": "June", "default":6},
      "JulRad": {"type": "number", "title": "July", "default":6},
      "AugRad": {"type": "number", "title": "August", "default":6},
      "SepRad": {"type": "number", "title": "September", "default":6},
      "OctRad": {"type": "number", "title": "October", "default":6},
      "NovRad": {"type": "number", "title": "November", "default":6},
      "DecRad": {"type": "number", "title": "December", "default":6},

      
      "zones": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "zoneName": {
              "title": "Zone Name",
              "type": "string",
              "maxLength": 16
            },
            "enabled": {
              "title": "Zone Enabled",
              "type": "boolean",
              "description": "Enable Zone [true]",
              "default": true
            },
            "adaptive": {
              "title": "Adaptive",
              "type": "boolean",
              "description": "Climate Adaptive Zone [true]",
              "default": true
            },
            "rainFactoring": {
              "title": "Rain Factor",
              "type": "boolean",
              "description": "Factor rain & respect threshold [true]",
              "default": true
            },
            "defDuration": {
              "title": "Default Time",
              "type": "number",
              "description": "Default zone duration in minutes [20][0-60]",
              "default": 20,
              "maximum": 60,
              "minimum": 0
            },
            "maxDuration": {
              "title": "Max Time",
              "type": "number",
              "description": "Maximum duration settable in minutes [30][0-60]",
              "default": 30,
              "maximum": 60,
              "minimum": 0
            },
            "rainThreshold": {
              "title": "Rain Threshold",
              "type": "number",
              "description": "Rain Threshold [2.5][0<-100]",
              "default": 2.5,
              "maximum": 100,
              "exclusiveMinimum": 0
            },
            "tweakFactor": {
              "title": "Tweak Factor",
              "type": "number",
              "description": "Tweak proposed watring in % [100][0<-200]",
              "default": 100,
              "maximum": 200,
              "exclusiveMinimum": 0
            },
            "dripLPH": {
              "title": "Drip LPH",
              "type": "number",
              "description": "Drip emmiter LPH",
              "default": 2
            },
            "dripNos": {
              "title": "Drip Nos",
              "type": "number",
              "description": "Number of drip emmiters",
              "default": 1
            },
            "dripArea": {
              "title": "Drip Area",
              "type": "number",
              "description": "Irrigation Area sq. meters",
              "default": 1
            },
            "efficiency": {
              "title": "Drip Efficiency",
              "type": "number",
              "description": "Irrigation Efficiency % [100][0<-100]",
              "default": 100,
              "maximum": 100,
              "exclusiveMinimum": 0
            },
            "cropCoef": {
              "title": "Crop Coefficient",
              "type": "number",
              "description": "Crop Coefficient [1][.1-1]",
              "default": 1,
              "maximum": 1,
              "minimum": 0.1
            },
              "plantDensity": {
              "title": "Plant Density",
              "type": "number",
              "description": "Plant Density [1][.5-1.3]",
              "default": 1,
              "maximum": 1.3,
              "minimum": 0.5
            },
              "expFactor": {
              "title": "Exposure",
              "type": "number",
              "description": "Exposure Factor [1][.5-1.4]",
              "default": 1,
              "maximum": 1.3,
              "minimum": 0.5
            },
            "wateringMonths": {
              "type": "array",
              "title": "Watering Months",
              "items": {
                "type": "string",
                "title": "Watering Months"
                },
            "default":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
            },
              "wateringWeekdays": {
              "type": "array",
              "title": "Watering Weekdays",
              "items": {
                "type": "string",
                "title": "Watering Days"
                },
                "default":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]
            }
          },
          "required": [ "zoneName" ]
        }
      }
    }
  },

  "form": [
    {
      "type": "help",
      "helpvalue": "<div class=\"alert alert-info\">Homebridge Smart Irrigation Sprinklers</div>"
    },
    {
      "key": "name",
      "type": "text"
    },
    
    {
      "type": "section",
      "title": "Primary Setup",
      "expandable": true,
      "expanded": false,
      "htmlClass": "row",
      "items": [
        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "verbosed"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "masterDisable"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "cycles"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "sunriseOffset"
          ]
        },

        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "lowThreshold"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "highThreshold"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-12",
          "items": ["keyAPI"]
        },

        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "latitude"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "longitude"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-4",
          "items": [
            "altitude"
          ]
        }
      ]
    },

    {
      "type": "section",
      "title": "Monthly Mean Daily Solar Radiiation Data [kWh/day]",
      "expandable": true,
      "expanded": false,
      "htmlClass": "row",
      "items": [
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "JanRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "FebRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "MarRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "AprRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "MayRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "JunRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "JulRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "AugRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "SepRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "OctRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "NovRad"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-2",
          "items": [
            "DecRad"
          ]
        }
      ]
    },
    {
    "key": "zones",
    "type": "tabarray",
    "maxItems": 8,
    "add": "New",
    "remove": "Delete",
    "style": { "remove": "btn-danger" },
    "title": "{{ value.zoneName || 'Zone ' + $index }}",
    "items": [

    {
      "type": "section",
      "title": "{{ value.zoneName || 'Zone ' + $index + ' Setup'}}",
      "expandable": true,
      "expanded": false,
      "htmlClass": "row",
      "items": [
        {
          "type": "section",
          "htmlClass": "col-xs-3",
          "items": [
            "zones[].zoneName"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-3",
          "items": [
            "zones[].enabled"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-3",
          "items": [
            "zones[].adaptive"
          ]
        },
        {
          "type": "section",
          "htmlClass": "col-xs-3",
          "items": [
            "zones[].rainFactoring"
          ]
        }
        ,
        {
          "type": "section",
          "htmlClass": "row",
          "items": [
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].defDuration"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].maxDuration"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].rainThreshold"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].tweakFactor"
              ]
            }
          ]
        }
        ,
        {
          "type": "section",
          "htmlClass": "row",
          "items": [
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].dripLPH"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].dripNos"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].dripArea"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-3",
              "items": [
                "zones[].efficiency"
              ]
            }
          ]
        },
        {
          "type": "section",
          "htmlClass": "row",
          "items": [
            {
              "type": "section",
              "htmlClass": "col-xs-4",
              "items": [
                "zones[].cropCoef"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-4",
              "items": [
                "zones[].plantDensity"
              ]
            },
            {
              "type": "section",
              "htmlClass": "col-xs-4",
              "items": [
                "zones[].expFactor"
              ]
            }
          ]
        },
        {"key": "zones[].wateringWeekdays",
         "inline": true,
         "type":"checkboxes",
         "titleMap": {
            "Sunday": "Sunday",
            "Monday": "Monday",
            "Tuesday": "Tuesday",
            "Wednesday": "Wednesday",
            "Thursday": "Thursday",
            "Friday": "Friday",
            "Saturday": "Saturday"
            }
        },
        {"key": "zones[].wateringMonths",
         "inline": true,
         "type":"checkboxes",
         "titleMap": {
            "Jan": "Jan",
            "Feb": "Feb",
            "Mar": "Mar",
            "Apr": "Apr",
            "May": "May",
            "Jun": "Jun",
            "Jul": "Jul",
            "Aug": "Aug",
            "Sep": "Sep",
            "Oct": "Oct",
            "Nov": "Nov",
            "Dec": "Dec"
            }
        }
      ]
    }
    ]
  }
]
}